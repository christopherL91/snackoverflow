(function () {
'use strict';

const sendCommand = (socket, command) => {
		//TODO socket stuff for sending commands
		socket.send(command);
		//console.log(command);
};

const createCommand = charName => {
		//{"command": "create", "name": <charName>}
		return JSON.stringify({ command: "create", name: charName });
};

const moveCommand = (CharName, x, y) => {
		//{"command": "move", "name": <charName>, "dx": [-1, 0, 1], "dy": [-1, 0, 1]}
		return JSON.stringify({ command: "move", name: CharName, dx: x, dy: y });
};

const scanCommand = CharName => {
		//{"command": "scan", "name": <charName>}
		return JSON.stringify({ command: "scan", name: CharName });
};

const setupKeyEvents = socket => {
		// listen for the "keypress" event
		document.onkeypress = function (e) {
				const charCode = typeof e.which == "number" ? e.which : e.keyCode;
				const key = charCode ? String.fromCharCode(charCode) : undefined;
				let playerName = 'ducky';
				if (key == 'q') {
						sendCommand(socket, moveCommand(playerName, -1, -1));
				} else if (key === 'w') {
						sendCommand(socket, moveCommand(playerName, 0, -1));
				} else if (key === 'e') {
						sendCommand(socket, moveCommand(playerName, 1, -1));
				} else if (key === 'a') {
						sendCommand(socket, moveCommand(playerName, -1, 0));
				} else if (key === 'd') {
						sendCommand(socket, moveCommand(playerName, 1, 0));
				} else if (key === 'z') {
						sendCommand(socket, moveCommand(playerName, -1, 1));
				} else if (key === 'x') {
						sendCommand(socket, moveCommand(playerName, 0, 1));
				} else if (key === 'c') {
						sendCommand(socket, moveCommand(playerName, 1, 1));
				} else if (key === 's') {
						sendCommand(socket, scanCommand(playerName));
				} else if (key === 'k') {
						sendCommand(socket, createCommand(playerName));
				}
		};
};

const statusOK = response => {
	if (response.status >= 200 && response.status < 300) {
		return response.json();
	} else {
		return Promise.reject();
	}
};

const getData = url => {
	return fetch(url, {
		method: "GET",
		headers: {
			"Content-Type": "application/json"
		}
	}).then(response => statusOK(response)).catch(error => {
		console.log(`Error: ${ error }`);
	});
};

const init = url => {
	const socketUrl = `ws://localhost:3000/ws`;
	const socket = new WebSocket(socketUrl);
	setupKeyEvents(socket);

	getData(url).then(data => {
		let dungeonmap = '';
		const { Area } = data;

		for (let i = 0; i < Area.length; i++) {
			for (let j = 0; j < Area[i].length; j++) {
				if (Area[i][j] == 1) {
					dungeonmap += '■';
				} else {
					dungeonmap += '□';
				}
			}
			dungeonmap += "<br/>";
		}
		const node = document.getElementById('map');
		node.innerHTML = dungeonmap;
	});
};

init('http://localhost:3000');

}());
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjpudWxsLCJzb3VyY2VzIjpbInNyYy9jb21tYW5kcy5qcyIsInNyYy9odHRwLmpzIiwic3JjL21haW4uanMiXSwic291cmNlc0NvbnRlbnQiOlsiXG5jb25zdCBzZW5kQ29tbWFuZCA9IChzb2NrZXQsIGNvbW1hbmQpID0+IHtcblx0Ly9UT0RPIHNvY2tldCBzdHVmZiBmb3Igc2VuZGluZyBjb21tYW5kc1xuXHRzb2NrZXQuc2VuZChjb21tYW5kKTtcblx0Ly9jb25zb2xlLmxvZyhjb21tYW5kKTtcbn1cblxuY29uc3QgY3JlYXRlQ29tbWFuZCA9IGNoYXJOYW1lID0+IHtcblx0Ly97XCJjb21tYW5kXCI6IFwiY3JlYXRlXCIsIFwibmFtZVwiOiA8Y2hhck5hbWU+fVxuXHRyZXR1cm4gSlNPTi5zdHJpbmdpZnkoe2NvbW1hbmQ6IFwiY3JlYXRlXCIsIG5hbWU6IGNoYXJOYW1lfSlcbn1cblxuY29uc3QgbW92ZUNvbW1hbmQgPSAoQ2hhck5hbWUsIHgsIHkpID0+IHtcblx0Ly97XCJjb21tYW5kXCI6IFwibW92ZVwiLCBcIm5hbWVcIjogPGNoYXJOYW1lPiwgXCJkeFwiOiBbLTEsIDAsIDFdLCBcImR5XCI6IFstMSwgMCwgMV19XG5cdHJldHVybiBKU09OLnN0cmluZ2lmeSh7Y29tbWFuZDogXCJtb3ZlXCIsIG5hbWU6IENoYXJOYW1lLCBkeDogeCwgZHk6IHl9KTtcbn1cblxuY29uc3Qgc2NhbkNvbW1hbmQgPSBDaGFyTmFtZSA9PiB7XG5cdC8ve1wiY29tbWFuZFwiOiBcInNjYW5cIiwgXCJuYW1lXCI6IDxjaGFyTmFtZT59XG5cdHJldHVybiBKU09OLnN0cmluZ2lmeSh7Y29tbWFuZDogXCJzY2FuXCIsIG5hbWU6IENoYXJOYW1lfSk7XG59XG5cbmV4cG9ydCBjb25zdCBzZXR1cEtleUV2ZW50cz0gKHNvY2tldCkgPT4ge1xuXHQvLyBsaXN0ZW4gZm9yIHRoZSBcImtleXByZXNzXCIgZXZlbnRcblx0ZG9jdW1lbnQub25rZXlwcmVzcyA9IGZ1bmN0aW9uKGUpIHtcblx0XHRjb25zdCBjaGFyQ29kZSA9ICh0eXBlb2YgZS53aGljaCA9PSBcIm51bWJlclwiKSA/IGUud2hpY2ggOiBlLmtleUNvZGU7XG5cdFx0Y29uc3Qga2V5ID0gY2hhckNvZGU/IFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpIDogdW5kZWZpbmVkO1xuXHRcdGxldCBwbGF5ZXJOYW1lID0gJ2R1Y2t5Jztcblx0ICBcdGlmIChrZXkgPT0gJ3EnKSB7XG5cdFx0XHRzZW5kQ29tbWFuZChzb2NrZXQsIG1vdmVDb21tYW5kKHBsYXllck5hbWUsIC0xLCAtMSkpXG5cdCAgXHR9IGVsc2UgaWYgKGtleSA9PT0gJ3cnKSB7XG5cdFx0XHRzZW5kQ29tbWFuZChzb2NrZXQsIG1vdmVDb21tYW5kKHBsYXllck5hbWUsIDAsIC0xKSlcblx0ICBcdH0gZWxzZSBpZiAoa2V5ID09PSAnZScpIHtcblx0XHRcdHNlbmRDb21tYW5kKHNvY2tldCwgbW92ZUNvbW1hbmQocGxheWVyTmFtZSwgMSwgLTEpKVxuXHQgIFx0fSBlbHNlIGlmIChrZXkgPT09ICdhJykge1xuXHRcdFx0c2VuZENvbW1hbmQoc29ja2V0LCBtb3ZlQ29tbWFuZChwbGF5ZXJOYW1lLCAtMSwgMCkpXG5cdCAgXHR9IGVsc2UgaWYgKGtleSA9PT0gJ2QnKSB7XG5cdFx0XHRzZW5kQ29tbWFuZChzb2NrZXQsIG1vdmVDb21tYW5kKHBsYXllck5hbWUsIDEsIDApKVxuXHQgIFx0fSBlbHNlIGlmIChrZXkgPT09ICd6Jykge1xuXHRcdFx0c2VuZENvbW1hbmQoc29ja2V0LCBtb3ZlQ29tbWFuZChwbGF5ZXJOYW1lLCAtMSwgMSkpXG5cdCAgXHR9IGVsc2UgaWYgKGtleSA9PT0gJ3gnKSB7XG5cdFx0XHRzZW5kQ29tbWFuZChzb2NrZXQsIG1vdmVDb21tYW5kKHBsYXllck5hbWUsIDAsIDEpKVxuXHQgIFx0fSBlbHNlIGlmIChrZXkgPT09ICdjJykge1xuXHRcdFx0c2VuZENvbW1hbmQoc29ja2V0LCBtb3ZlQ29tbWFuZChwbGF5ZXJOYW1lLCAxLCAxKSlcblx0ICBcdH0gZWxzZSBpZiAoa2V5ID09PSAncycpIHtcblx0XHRcdHNlbmRDb21tYW5kKHNvY2tldCwgc2NhbkNvbW1hbmQocGxheWVyTmFtZSkpXG5cdCAgXHR9IGVsc2UgaWYgKGtleSA9PT0gJ2snKSB7XG5cdFx0XHRzZW5kQ29tbWFuZChzb2NrZXQsIGNyZWF0ZUNvbW1hbmQocGxheWVyTmFtZSkpXG5cdCAgXHR9IFxuXHR9O1xufTsiLCIndXNlIHN0cmljdCc7XG5cbmNvbnN0IHN0YXR1c09LID0gKHJlc3BvbnNlKSA9PiB7XG5cdGlmKHJlc3BvbnNlLnN0YXR1cyA+PSAyMDAgJiYgcmVzcG9uc2Uuc3RhdHVzIDwgMzAwKSB7XG5cdFx0cmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcblx0fSBlbHNlIHtcblx0XHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoKTtcblx0fVxufTtcblxuZXhwb3J0IGNvbnN0IGdldERhdGEgPSAodXJsKSA9PiB7XG5cdHJldHVybiBmZXRjaCh1cmwsIHtcblx0ICBcdG1ldGhvZDogXCJHRVRcIixcblx0ICBcdGhlYWRlcnM6IHtcblx0ICAgIFx0XCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcblx0ICBcdH1cblx0fSlcblx0LnRoZW4ocmVzcG9uc2UgPT4gc3RhdHVzT0socmVzcG9uc2UpKVxuXHQuY2F0Y2goZXJyb3IgPT4ge1xuXHQgICAgY29uc29sZS5sb2coYEVycm9yOiAke2Vycm9yfWApO1xuXHR9KTtcbn07IiwiJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQge3NldHVwS2V5RXZlbnRzfSBmcm9tICcuL2NvbW1hbmRzLmpzJztcbmltcG9ydCB7Z2V0RGF0YX0gZnJvbSAnLi9odHRwLmpzJztcblxuY29uc3QgaW5pdCA9ICh1cmwpID0+IHtcblx0Y29uc3Qgc29ja2V0VXJsID0gYHdzOi8vbG9jYWxob3N0OjMwMDAvd3NgO1xuXHRjb25zdCBzb2NrZXQgPSBuZXcgV2ViU29ja2V0KHNvY2tldFVybCk7XG5cdHNldHVwS2V5RXZlbnRzKHNvY2tldCk7XG5cdFxuXHRnZXREYXRhKHVybClcblx0LnRoZW4oZGF0YSA9PiB7XG5cdFx0bGV0IGR1bmdlb25tYXAgPSAnJztcblx0XHRjb25zdCB7QXJlYX0gPSBkYXRhO1xuXG5cdCAgICBmb3IgKGxldCBpID0gMDsgaSA8IEFyZWEubGVuZ3RoOyBpKyspIHtcblx0XHRcdGZvciAobGV0IGogPSAwOyBqIDwgQXJlYVtpXS5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRpZihBcmVhW2ldW2pdID09IDEpIHtcblx0XHRcdFx0XHRkdW5nZW9ubWFwICs9ICfilqAnO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGR1bmdlb25tYXAgKz0gJ+KWoSc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGR1bmdlb25tYXAgKz0gXCI8YnIvPlwiO1xuXHRcdH1cblx0ICAgIGNvbnN0IG5vZGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyk7XG5cdCAgICBub2RlLmlubmVySFRNTCA9IGR1bmdlb25tYXA7XG5cdH0pO1xufTtcblxuaW5pdCgnaHR0cDovL2xvY2FsaG9zdDozMDAwJyk7Il0sIm5hbWVzIjpbInNlbmRDb21tYW5kIiwic29ja2V0IiwiY29tbWFuZCIsInNlbmQiLCJjcmVhdGVDb21tYW5kIiwiY2hhck5hbWUiLCJKU09OIiwic3RyaW5naWZ5IiwibmFtZSIsIm1vdmVDb21tYW5kIiwiQ2hhck5hbWUiLCJ4IiwieSIsImR4IiwiZHkiLCJzY2FuQ29tbWFuZCIsInNldHVwS2V5RXZlbnRzIiwib25rZXlwcmVzcyIsImUiLCJjaGFyQ29kZSIsIndoaWNoIiwia2V5Q29kZSIsImtleSIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsInVuZGVmaW5lZCIsInBsYXllck5hbWUiLCJzdGF0dXNPSyIsInJlc3BvbnNlIiwic3RhdHVzIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJnZXREYXRhIiwidXJsIiwiZmV0Y2giLCJ0aGVuIiwiY2F0Y2giLCJlcnJvciIsImxvZyIsImluaXQiLCJzb2NrZXRVcmwiLCJXZWJTb2NrZXQiLCJkYXRhIiwiZHVuZ2Vvbm1hcCIsIkFyZWEiLCJpIiwibGVuZ3RoIiwiaiIsIm5vZGUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaW5uZXJIVE1MIl0sIm1hcHBpbmdzIjoiOzs7QUFDQSxNQUFNQSxjQUFjLENBQUNDLE1BQUQsRUFBU0MsT0FBVCxLQUFxQjs7U0FFakNDLElBQVAsQ0FBWUQsT0FBWjs7Q0FGRDs7QUFNQSxNQUFNRSxnQkFBZ0JDLFlBQVk7O1NBRTFCQyxLQUFLQyxTQUFMLENBQWUsRUFBQ0wsU0FBUyxRQUFWLEVBQW9CTSxNQUFNSCxRQUExQixFQUFmLENBQVA7Q0FGRDs7QUFLQSxNQUFNSSxjQUFjLENBQUNDLFFBQUQsRUFBV0MsQ0FBWCxFQUFjQyxDQUFkLEtBQW9COztTQUVoQ04sS0FBS0MsU0FBTCxDQUFlLEVBQUNMLFNBQVMsTUFBVixFQUFrQk0sTUFBTUUsUUFBeEIsRUFBa0NHLElBQUlGLENBQXRDLEVBQXlDRyxJQUFJRixDQUE3QyxFQUFmLENBQVA7Q0FGRDs7QUFLQSxNQUFNRyxjQUFjTCxZQUFZOztTQUV4QkosS0FBS0MsU0FBTCxDQUFlLEVBQUNMLFNBQVMsTUFBVixFQUFrQk0sTUFBTUUsUUFBeEIsRUFBZixDQUFQO0NBRkQ7O0FBS0EsQUFBTyxNQUFNTSxpQkFBaUJmLE1BQUQsSUFBWTs7V0FFL0JnQixVQUFULEdBQXNCLFVBQVNDLENBQVQsRUFBWTtVQUMzQkMsV0FBWSxPQUFPRCxFQUFFRSxLQUFULElBQWtCLFFBQW5CLEdBQStCRixFQUFFRSxLQUFqQyxHQUF5Q0YsRUFBRUcsT0FBNUQ7VUFDTUMsTUFBTUgsV0FBVUksT0FBT0MsWUFBUCxDQUFvQkwsUUFBcEIsQ0FBVixHQUEwQ00sU0FBdEQ7UUFDSUMsYUFBYSxPQUFqQjtRQUNNSixPQUFPLEdBQVgsRUFBZ0I7a0JBQ0xyQixNQUFaLEVBQW9CUSxZQUFZaUIsVUFBWixFQUF3QixDQUFDLENBQXpCLEVBQTRCLENBQUMsQ0FBN0IsQ0FBcEI7S0FEQyxNQUVPLElB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
